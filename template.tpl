___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "displayName": "Adxcg Simple Pixel",
  "description": "Pixel helps you to create audience based on user\u0027s who visit\u0027s your website.",
  "categories": [
    "REMARKETING",
    "LEAD_GENERATION",
    "ADVERTISING"
  ],
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1,
  "brand": {
    "displayName": "",
    "id": "brand_dummy",
    "thumbnail": "data:image/png;base64,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\u003d"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "help": "Please copy \u0026 paste Pixel ID from Advertiser control panel",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "args": [
          "^[0-9]+$"
        ],
        "type": "REGEX"
      }
    ],
    "displayName": "Partner ID",
    "simpleValueType": true,
    "name": "partnerId",
    "type": "TEXT"
  },
  {
    "help": "Please copy \u0026 paste Segment ID from Advertiser control panel",
    "valueValidators": [
      {
        "args": [
          "^[0-9]+$"
        ],
        "errorMessage": "",
        "type": "REGEX"
      }
    ],
    "displayName": "Add Segment ID",
    "simpleValueType": true,
    "name": "addSegmentId",
    "type": "TEXT"
  },
  {
    "help": "Please copy \u0026 paste Segment ID from Advertiser control panel",
    "valueValidators": [
      {
        "args": [
          "^[0-9]+$"
        ],
        "errorMessage": "",
        "type": "REGEX"
      }
    ],
    "displayName": "Remove Segment ID",
    "simpleValueType": true,
    "name": "removeSegmentId",
    "type": "TEXT"
  },
  {
    "type": "TEXT",
    "name": "endPoint",
    "displayName": "Beacon endpoint",
    "simpleValueType": true,
    "defaultValue": "https://cdn.adxcg.net/autopix.js",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      },
      {
        "type": "REGEX",
        "args": [
          "https://cdn.adxcg.net/.*"
        ]
      }
    ]
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

//version
const version = 'gtm-v1';
const plainname = 'GTM-adxcg.com Simple pixel -' + version;
const queueName = 'adxcgq';

// API import - general parts
const log = require('logToConsole');
const queryPermission = require('queryPermission');
const createQueue = require('createQueue');
const injectScript = require('injectScript');
const makeInteger = require('makeInteger');

// read data Form variables
const addSegmentId = data.addSegmentId;
const removeSegmentId = data.removeSegmentId;
const autotagurl = data.endPoint;

// create queue
const _qPush = createQueue(queueName);
log(plainname + ': createQueue completed');

// prepare payload object
let postData = {};
if (addSegmentId !== undefined) {
    postData.pixel = [makeInteger(addSegmentId)];
}

if (addSegmentId !== undefined) {
    postData.removePixel = [makeInteger(removeSegmentId)];
}

// If the script loaded successfully, log a message and signal success
const onSuccess = () => {
    log(plainname + ': Script loaded successfully. Sending payload');
    _qPush(postData);
    log(plainname + ': Sending to queue completed');
    data.gtmOnSuccess();
};

// If the script fails to load, log a message and signal failure
const onFailure = () => {
    log(plainname + ': Script load failed.');
    data.gtmOnFailure();
};

log(plainname + ': using script - ' + autotagurl);
if (queryPermission('inject_script', autotagurl)) {
    injectScript(autotagurl, onSuccess, onFailure);
} else {
    log(plainname + ': Script load failed due to permissions mismatch. - inject_script -' + autotagurl);
    data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "all"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "adxcgq"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.adxcg.net/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 18/09/2019, 12:05:34

